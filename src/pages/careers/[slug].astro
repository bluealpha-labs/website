---
import Layout from '#layouts/layout.astro'
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const collection = await getCollection('careers')
  const published = collection.filter((career) => career.data.status === 'Published')
  return published.map((career) => ({ params: { slug: career.slug }, props: { career } }))
}

const { career } = Astro.props
const { Content } = await career.render()
const title = `${career.data.title} — BlueAlpha Careers`
const description = `${career.data.title} in ${career.data.department} · ${career.data.locations.join(', ')}`
---

<Layout
  {title}
  {description}>
  <article class='mx-auto max-w-4xl px-6 pt-40 pb-20'>
    <header class='mb-8'>
      <a
        href='/careers'
        class='text-sm text-stone-600 hover:text-stone-900'
        >← Back to careers</a
      >
      <h1 class='mt-4 text-3xl font-semibold tracking-tight md:text-5xl'>{career.data.title}</h1>
      <div class='mt-6 flex flex-wrap items-center gap-2 text-sm text-stone-700'>
        {
          career.data.locations.map((loc) => (
            <span class='inline-flex items-center rounded-full border border-stone-200 px-2.5 py-1'>{loc}</span>
          ))
        }
      </div>
    </header>

    <div
      class='prose prose-stone prose-headings:font-semibold prose-headings:tracking-tight prose-h1:text-3xl md:prose-h1:text-4xl prose-h1:mt-12 prose-h2:text-2xl md:prose-h2:text-3xl prose-h2:mt-10 prose-h3:text-xl md:prose-h3:text-2xl prose-h3:mt-8 prose-p:text-stone-800 prose-p:leading-7 prose-a:text-stone-900 prose-a:font-medium hover:prose-a:underline prose-strong:text-stone-900 prose-code:text-stone-900 prose-code:bg-stone-100 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-pre:bg-stone-950 prose-pre:text-stone-100 prose-pre:rounded-xl prose-pre:p-5 prose-li:my-1 prose-ul:my-4 prose-ol:my-4 prose-hr:my-10 prose-hr:border-stone-200 prose-blockquote:border-l-stone-300 mt-10 max-w-none'>
      <Content />
    </div>
  </article>
</Layout>
