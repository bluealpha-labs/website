---
import Layout from '#layouts/layout.astro'
import { getCollection } from 'astro:content'

const collection = await getCollection('playbooks')
const published = collection.filter((entry) => entry.data.status === 'Published')
const playbooks = published.sort((a, b) => (a.data.order ?? 0) - (b.data.order ?? 0))
---

<Layout>
  <section class='mx-auto min-h-screen max-w-5xl px-6 pt-40 pb-20'>
    <header class='mb-12'>
      <h1 class='text-3xl font-semibold tracking-tight md:text-5xl'>Playbooks</h1>
      <p class='mt-4 max-w-2xl text-stone-600'>Proven, pragmatic growth playbooks for marketing and product leaders.</p>
    </header>

    <ul class='grid gap-6 md:grid-cols-2'>
      {
        playbooks.map((entry) => (
          <li>
            <a
              href={`/playbooks/${entry.slug}`}
              class='group block overflow-hidden rounded-2xl border border-stone-200 no-underline transition-colors hover:bg-stone-50'>
              {entry.data.image && (
                <img
                  src={entry.data.image}
                  alt={entry.data.title}
                  class='aspect-[16/9] w-full object-cover'
                />
              )}
              <div class='p-6'>
                <h2 class='text-xl font-semibold tracking-tight md:text-2xl'>{entry.data.title}</h2>
                {entry.data.subtitle && <p class='mt-2 line-clamp-2 text-stone-600'>{entry.data.subtitle}</p>}
                {entry.data.tags && entry.data.tags.length > 0 && (
                  <div class='mt-4 flex flex-wrap gap-2 text-sm text-stone-700'>
                    {entry.data.tags.map((tag) => (
                      <span class='inline-flex items-center rounded-full border border-stone-200 px-2.5 py-1'>
                        {tag}
                      </span>
                    ))}
                  </div>
                )}
                <div class='mt-4 text-sm font-medium text-stone-700 group-hover:text-stone-900'>Read playbook â†’</div>
              </div>
            </a>
          </li>
        ))
      }
    </ul>
  </section>
</Layout>
